<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
 body {
    font-family: Arial, sans-serif; /* Set a clean font for the browser */
    background-color: #f5f5f5; /* Light background for better contrast */
    margin: 0; /* Remove default margin */
}

#browser-container {
    margin-top: 10%;
    display: grid;
    grid-template-columns: 1fr 1fr 3fr;
    gap: 20px; /* Add space between columns */
}

#file-navigation {
    display: flex;
    flex-direction: column;
    background-color: #fff; /* White background for the navigation */
    border: 1px solid #ddd; /* Light border for separation */
    border-radius: 5px; /* Rounded corners */
    padding: 10px; /* Inner padding */
}

#arrows {
    display: flex;
    justify-content: space-between;
}

button {
    padding: 8px 12px; /* Button padding */
    font-size: 14px; /* Button font size */
    border: none; /* Remove default borders */
    border-radius: 4px; /* Rounded corners for buttons */
    background-color: #007bff; /* Bootstrap primary color */
    color: white; /* White text for buttons */
    cursor: pointer; /* Pointer cursor on hover */
}

button:hover {
    background-color: #0056b3; /* Darken button on hover */
}

#search {
    margin-top: 10px; /* Space above search */
}

#search input {
    width: 100%; /* Full width input */
    padding: 8px; /* Padding for the input */
    border: 1px solid #ddd; /* Light border */
    border-radius: 4px; /* Rounded corners */
    font-size: 14px; /* Input font size */
}

#browser {
    background-color: #fff; /* White background for content area */
    border: 1px solid #ddd; /* Light border for content area */
    border-radius: 5px; /* Rounded corners */
    padding: 10px; /* Inner padding */
}

#content-viewer {
    display: flex;
    flex-direction: column;
    margin-top: 10px; /* Space above content */
}

.folder, .file {
    cursor: pointer;
    padding: 10px; /* Padding for items */
    border-bottom: 1px solid #ddd; /* Light border below items */
    display: flex;
    align-items: center; /* Center align items */
}

.folder:hover, .file:hover {
    background-color: #f0f0f0; /* Light background on hover */
}

.folder img, .file img {
    width: 24px; /* Set width for icons */
    height: 24px; /* Set height for icons */
    margin-right: 10px; /* Space between icon and text */
}

.file p, .folder p {
    margin: 0; /* Remove default margin */
    font-size: 14px; /* Set font size */
    color: #333; /* Darker text for better visibility */
}

    </style>
</head>
<body>

    <div id="browser-container">
        <div id="file-navigation">
            <div id="arrows">
                <button id="back-btn" disabled>Back</button>
                <button id="up-btn">Up</button>
            </div>
            <div id="dir-content">
                
            </div>
        </div>

        <div id="browser">
            <div id="top">
                <div id="search">
                    <input type="text" id="search-input" placeholder="Search files...">
                </div>
            </div>
            <div id="content-viewer">
                CONTENT
            </div>
        </div>
    </div>

    <script>
        // Get file system data from localStorage (as JSON)
        let fileSystem = JSON.parse(localStorage.getItem("fileSystem")) || [];

        // Pointer to current directory
        let currentDir = "/";
        let history = [];  // To track directory history for back button

        // Function to render the current directory content
        function renderCurrentDir() {
            // Find the current directory object
            let dirObject = null
            console.log(fileSystem.length)
            for (let i = 0; i < fileSystem.length; i++) {
                console.log(fileSystem[i])
                if (fileSystem[i].dir == currentDir) {
                    //this should be parent
                    dirObject = fileSystem[i];
                    break
                }
            }
            let dirContent = document.getElementById('content-viewer');
            dirContent.innerHTML = ''; // Clear current content

            if (!dirObject) {
                console.log("file system error")
                return
            }; // Handle case if directory not found

            console.log(dirObject.files, "??")
            dirObject.files.forEach(file => {
               console.log("???", file)
                let fileElement = document.createElement('div');

                let fileElementTitle = document.createElement('p');
                let fileElementImage = document.createElement('img');
                fileElement.className = file.dir ? 'folder' : 'file';
                fileElementTitle.textContent = file.name;

                if (file.dir){
                    fileElementImage.src="images/File_System_icon.png"
                }else {

                    fileElementImage.src="images/Notes.png"
                }
                fileElement.appendChild(fileElementImage)

                fileElement.appendChild(fileElementTitle)
                fileElement.addEventListener('click', () => {
                    if (file.dir) {
                        // If it's a folder, navigate into it
                        history.push(currentDir);
                        currentDir = file.name;
                        renderCurrentDir();
                    } else {
                        // Display file content if it's a file
                        //need an event to open notes 
                        displayFileContent(file);
                    }
                });

                dirContent.appendChild(fileElement);
            });

            // Enable or disable the "Back" button based on history
            document.getElementById('back-btn').disabled = history.length === 0;
       
        }

    

        // Navigate back in directory history
        document.getElementById('back-btn').addEventListener('click', () => {
            if (history.length > 0) {
                currentDir = history.pop();
                renderCurrentDir();
            }
        });

        // Navigate up in the directory hierarchy
        document.getElementById('up-btn').addEventListener('click', () => {
            if (currentDir !== "/") {
                let parentDir = currentDir.substring(0, currentDir.lastIndexOf('/')) || "/";
                currentDir = parentDir;
                renderCurrentDir();
            }
        });
        document.getElementById('up-btn').disabled = currentDir=="/"

        // Initial render
        renderCurrentDir();
    </script>

</body>
</html>
