<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content=" David Kozdra is a computer science student at Florida Polytechnic university">
  <meta name="keywords" content="Computer Science ">
  <meta name="author" content="David Kozdra">

  <title>David Kozdra</title>

  <link rel="stylesheet" href="styles/DEstyles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="/images/favicon.ico">

</head>
<body>
  
  <div class="task-bar">
 <!-- Navigation Menu -->

 <div class="navigation">
    <div class="drop-down">
      <button> DK</button> 
        <div class="drop-down-content">     
          <button > test 1</button>
          <button > test 2</button>
          <button > Power</button>
        </div>
    </div>
    <div class="drop-down">
      <button> About</button> 
    </div>
    <div class="drop-down">
      <button> Programs</button> 
        <div class="drop-down-content">     
          <button > test 1</button>
          <button > test 2</button>
          <button > Power</button>
        </div>
    </div>
    
    <div class="drop-down">
      <button onclick="openWindow(event,'resume')"> Resume</button> 
    </div>
  </div>

    <div class="status-bar">
      <div id="clock">  </div>
      
      <div id="weather">  </div>
      
      <div id="Contact"> github linkedin itch  </div>
     
      <div> <i class="fas fa-wifi"></i> </div>
    </div>
</div>

  <div id="desktop">
    <div id="windows">
   
    </div>

    <div class="desktop-grid">

      <div class="desktop-icon" onclick="selectIcon(event)" ondblclick="desktopIconRouter(event,'test')" tabindex="1"> 
        <img src="./images/blocks.jpg"></img>

          <p class="icon-text">Game 1</p>

      </div>

      <div class="desktop-icon" onclick="selectIcon(event)" ondblclick="desktopIconRouter(event,'test')" tabindex="1"> 
        <img src="./images/blocks.jpg"></img>
        <div class="icon-text">
          <p >Game 1</p>
        </div>
      </div>


    </div>


  <script> 


    function DisplayDate(){
      var date = new Date();
      var hours = date.getHours();
      var minutes = date.getMinutes();
      var seconds = date.getSeconds();
      var ampm = "AM";
      if(hours > 12){
        hours = hours - 12;
        ampm = "PM";
      }
      if(hours == 0){
        hours = 12;
      }
      if(minutes < 10){
        minutes = "0" + minutes;
      }
      if(seconds < 10){
        seconds = "0" + seconds;
      }
      var time = hours + ":" + minutes + ":" + seconds + " " + ampm;
      document.getElementById("clock").innerHTML = time;
    }

    setInterval(DisplayDate, 500);


  function closeWindow(e,name) {
    // close the parent window from the event target
    e.target.parentNode.parentNode.parentNode.remove();

  }

  function minimizeWindow(e,name) {
    e.target.parentNode.parentNode.parentNode.style.display = "none";
  }

  function maximizeWindow(e,name) {
    console.log("maximize");
    let window =  e.target.parentNode.parentNode.parentNode;

    // e.target needs to be a window button 
    //add larger class
    if (window != null ) {
      window.classList.toggle("larger");
      (window.classList.contains("larger")) ? e.target.innerHTML = "~" : e.target.innerHTML = "[]";
      console.log(e.target.innerHTML);
    }
  }



  function dragElement(title,elmnt) {
  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  
  // If present, the header is where you move the DIV from:
  title.onmousedown = dragMouseDown;

  function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    // Get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // Call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // Calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    
    // Check boundaries
    const newTop = Math.max(0, Math.min(elmnt.offsetTop - pos2, window.innerHeight - elmnt.offsetHeight));
    const newLeft = Math.max(0, Math.min(elmnt.offsetLeft - pos1, window.innerWidth - elmnt.offsetWidth));

    // Set the element's new position:
    elmnt.style.top = newTop + "px";
    elmnt.style.left = newLeft + "px";
  }

  function closeDragElement() {
    // Stop moving when the mouse button is released:
    document.onmouseup = null;
    document.onmousemove = null;
  }
}

function setCursor() {
  //conditionally set the cursor to wait globally
  document.body.style.cursor = "wait";
} 

function deselectAllIcons() {
  let desktopIcons = document.getElementsByClassName("desktop-icon");
  for (let i = 0; i < desktopIcons.length; i++) {
    desktopIcons[i].classList.remove("active");
  }
}

function selectIcon(e) {
  console.log(e.target);
  if (!e.target.classList.contains("icon-text")) {
    e.target.classList.toggle("active");
  }


  e.target.classList.toggle("active");
}function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function desktopIconRouter(e, newWindowHeaderTitle) {
    // Set the cursor to the waiting state
    setCursor(e);
  
    // Wait for the specified delay
    await delay((Math.random() * 1000) + 200);

    // Now the delay is complete, proceed to open the window
    switch (newWindowHeaderTitle) {
        case "test":
            createTestWindow();
            break;
        case "resume":
            createResumeWindow();
            break;
        default:
            console.log("Window not found");
            break;
    }

    // Reset the cursor to the default state
    document.body.style.cursor = "default";
}

function setCursor(e) {
    // Your cursor-setting logic here
    document.body.style.cursor = "wait";
    // set important cursor styles

    e.target.style.cursor = "wait";

}


function createTestWindow() {

    // create new window
    let newWindow = document.createElement("div");
    newWindow.classList.add("window");
    newWindow.id = "test";

    let newWindowHeader = document.createElement("div");
    newWindowHeader.classList.add("window-title");

    let newWindowHeaderTitle = document.createElement("p");
    newWindowHeaderTitle.innerHTML = "Blocks";

    let newWindowHeaderButtons = document.createElement("div");
    newWindowHeaderButtons.classList.add("window-buttons");

    let newWindowHeaderButtonMin = document.createElement("button");
    newWindowHeaderButtonMin.classList.add("window-button");
    newWindowHeaderButtonMin.innerHTML = "_";

    let newWindowHeaderButtonMax = document.createElement("button");
    newWindowHeaderButtonMax.classList.add("window-button");
    newWindowHeaderButtonMax.innerHTML = "[]";

    let newWindowHeaderButtonClose = document.createElement("button");
    newWindowHeaderButtonClose.classList.add("window-button");
    newWindowHeaderButtonClose.innerHTML = "X";

    let newWindowContent = document.createElement("div");
    newWindowContent.classList.add("window-content");

    let newWindowContentText = document.createElement("p");
    newWindowContentText.innerHTML = "test";

    newWindowHeaderButtonClose.addEventListener('click', function() {
        closeWindow(event,newWindow.id);
    });

    newWindowHeaderButtonMin.addEventListener('click', function() {
        minimizeWindow(event,newWindow.id);
    });

    newWindowHeaderButtonMax.addEventListener('click', function() {
        maximizeWindow(event,newWindow.id);
    });

    newWindowHeaderButtons.appendChild(newWindowHeaderButtonMin);
    newWindowHeaderButtons.appendChild(newWindowHeaderButtonMax);
    newWindowHeaderButtons.appendChild(newWindowHeaderButtonClose);

    newWindowHeader.appendChild(newWindowHeaderTitle);
    newWindowHeader.appendChild(newWindowHeaderButtons);
    newWindow.appendChild(newWindowHeader);

    newWindowContent.appendChild(newWindowContentText);
    newWindow.appendChild(newWindowContent);
    newWindow.style.display = "block";

    document.getElementById("windows").appendChild(newWindow);

    let window_headers = document.getElementsByClassName("window-title");
    let windows = document.getElementsByClassName("window");

    for (let i = 0; i < windows.length; i++) {
        dragElement(window_headers[i], windows[i]);
    }
}


  
</script>


</body>
</html>